!function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var xhr_1=require("../xhr"),authorization_request_1=require("../authorization_request"),authorization_request_handler_1=require("../authorization_request_handler"),authorization_service_configuration_1=require("../authorization_service_configuration"),logger_1=require("../logger"),redirect_based_handler_1=require("../redirect_based_handler"),token_request_1=require("../token_request"),token_request_handler_1=require("../token_request_handler"),openIdConnectUrl="",clientId="",redirectUri="",scope="",App=function(){function App(config){var _this=this;openIdConnectUrl=config.openIdConnectUrl,clientId=config.clientId,redirectUri=config.redirectUri,scope=config.scope,this.notifier=new authorization_request_handler_1.AuthorizationNotifier,this.authorizationHandler=new redirect_based_handler_1.RedirectRequestHandler,this.tokenHandler=new token_request_handler_1.BaseTokenRequestHandler,this.authorizationHandler.setAuthorizationNotifier(this.notifier),this.notifier.setAuthorizationListener(function(request,response,error){logger_1.log("Authorization request complete ",request,response,error),response&&(_this.request=request,_this.response=response,_this.code=response.code,_this.showMessage("Authorization Code "+response.code))})}return App.prototype.showMessage=function(message){logger_1.log(message)},App.prototype.login=function(){var _this=this;authorization_service_configuration_1.AuthorizationServiceConfiguration.fetchFromIssuer(openIdConnectUrl).then(function(response){logger_1.log("Fetched service configuration",response),_this.configuration=response,_this.showMessage("Completed fetching configuration"),_this.makeAuthorizationRequest()}).catch(function(error){logger_1.log("Something bad happened",error),_this.showMessage("Something bad happened "+error)})},App.prototype.fetchServiceConfiguration=function(){var _this=this;authorization_service_configuration_1.AuthorizationServiceConfiguration.fetchFromIssuer(openIdConnectUrl).then(function(response){logger_1.log("Fetched service configuration",response),_this.configuration=response,_this.showMessage("Completed fetching configuration")}).catch(function(error){logger_1.log("Something bad happened",error),_this.showMessage("Something bad happened "+error)})},App.prototype.makeAuthorizationRequest=function(){var request=new authorization_request_1.AuthorizationRequest({client_id:clientId,redirect_uri:redirectUri,scope:scope,response_type:authorization_request_1.AuthorizationRequest.RESPONSE_TYPE_CODE,state:void 0,extras:{prompt:"consent",access_type:"offline"}});this.configuration?this.authorizationHandler.performAuthorizationRequest(this.configuration,request):this.showMessage("Fetch Authorization Service configuration, before you make the authorization request.")},App.prototype.getToken=function(cb){var _this=this;authorization_service_configuration_1.AuthorizationServiceConfiguration.fetchFromIssuer(openIdConnectUrl).then(function(response){logger_1.log("Fetched service configuration",response),_this.configuration=response,_this.showMessage("Completed fetching configuration"),_this.makeTokenRequest(cb)}).catch(function(error){logger_1.log("Something bad happened",error),_this.showMessage("Something bad happened "+error)})},App.prototype.makeTokenRequest=function(cb){var _this=this;if(this.configuration){var request=null;if(this.code){var extras=void 0;this.request&&this.request.internal&&((extras={}).code_verifier=this.request.internal.code_verifier),request=new token_request_1.TokenRequest({client_id:clientId,redirect_uri:redirectUri,grant_type:token_request_1.GRANT_TYPE_AUTHORIZATION_CODE,code:this.code,refresh_token:void 0,extras:extras})}else this.tokenResponse&&(request=new token_request_1.TokenRequest({client_id:clientId,redirect_uri:redirectUri,grant_type:token_request_1.GRANT_TYPE_REFRESH_TOKEN,code:void 0,refresh_token:this.tokenResponse.refreshToken,extras:void 0}));request&&this.tokenHandler.performTokenRequest(this.configuration,request).then(function(response){_this.tokenResponse=response,_this.code=void 0,cb(response)}).catch(function(error){logger_1.log("Something bad happened",error),_this.showMessage("Something bad happened "+error)})}else this.showMessage("Please fetch service configuration.")},App.prototype.checkAuth=function(cb){var _this=this;this.authorizationHandler.completeAuthorizationRequestIfPossible(function(){_this.getToken(cb)})},App.prototype.getUserInfo=function(token,cb){var fullUrl=openIdConnectUrl+"/userinfo";return(new xhr_1.JQueryRequestor).xhr({url:fullUrl,dataType:"json",headers:{Authorization:"Bearer "+token}}).then(function(json){return cb(json),json})},App}();exports.App=App,window.App=App},{"../authorization_request":2,"../authorization_request_handler":3,"../authorization_service_configuration":5,"../logger":9,"../redirect_based_handler":11,"../token_request":13,"../token_request_handler":14,"../xhr":16}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var crypto_utils_1=require("./crypto_utils"),logger_1=require("./logger"),AuthorizationRequest=function(){function AuthorizationRequest(request,crypto,usePkce){void 0===crypto&&(crypto=new crypto_utils_1.DefaultCrypto),void 0===usePkce&&(usePkce=!0),this.crypto=crypto,this.usePkce=usePkce,this.clientId=request.client_id,this.redirectUri=request.redirect_uri,this.scope=request.scope,this.responseType=request.response_type||AuthorizationRequest.RESPONSE_TYPE_CODE,this.state=request.state||function(crypto){return crypto.generateRandom(10)}(crypto),this.extras=request.extras,this.internal=request.internal}return AuthorizationRequest.prototype.setupCodeVerifier=function(){var _this=this;if(this.usePkce){var codeVerifier_1=this.crypto.generateRandom(128);return this.crypto.deriveChallenge(codeVerifier_1).catch(function(error){logger_1.log("Unable to generate PKCE challenge. Not using PKCE",error)}).then(function(result){result&&(_this.internal=_this.internal||{},_this.internal.code_verifier=codeVerifier_1,_this.extras=_this.extras||{},_this.extras.code_challenge=result,_this.extras.code_challenge_method="S256")})}return Promise.resolve()},AuthorizationRequest.prototype.toJson=function(){var _this=this;return this.setupCodeVerifier().then(function(){return{response_type:_this.responseType,client_id:_this.clientId,redirect_uri:_this.redirectUri,scope:_this.scope,state:_this.state,extras:_this.extras,internal:_this.internal}})},AuthorizationRequest.RESPONSE_TYPE_TOKEN="token",AuthorizationRequest.RESPONSE_TYPE_CODE="code",AuthorizationRequest}();exports.AuthorizationRequest=AuthorizationRequest},{"./crypto_utils":6,"./logger":9}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var logger_1=require("./logger"),AuthorizationNotifier=function(){function AuthorizationNotifier(){this.listener=null}return AuthorizationNotifier.prototype.setAuthorizationListener=function(listener){this.listener=listener},AuthorizationNotifier.prototype.onAuthorizationComplete=function(request,response,error){this.listener&&this.listener(request,response,error)},AuthorizationNotifier}();exports.AuthorizationNotifier=AuthorizationNotifier,exports.BUILT_IN_PARAMETERS=["redirect_uri","client_id","response_type","state","scope"];var AuthorizationRequestHandler=function(){function AuthorizationRequestHandler(utils,crypto){this.utils=utils,this.crypto=crypto,this.notifier=null}return AuthorizationRequestHandler.prototype.buildRequestUrl=function(configuration,request){var requestMap={redirect_uri:request.redirectUri,client_id:request.clientId,response_type:request.responseType,state:request.state,scope:request.scope};if(request.extras)for(var extra in request.extras)request.extras.hasOwnProperty(extra)&&exports.BUILT_IN_PARAMETERS.indexOf(extra)<0&&(requestMap[extra]=request.extras[extra]);var query=this.utils.stringify(requestMap);return configuration.authorizationEndpoint+"?"+query},AuthorizationRequestHandler.prototype.completeAuthorizationRequestIfPossible=function(cb){var _this=this;return logger_1.log("Checking to see if there is an authorization response to be delivered."),this.notifier||logger_1.log("Notifier is not present on AuthorizationRequest handler.\n          No delivery of result will be possible"),this.completeAuthorizationRequest().then(function(result){result||logger_1.log("No result is available yet."),result&&_this.notifier&&(cb(),_this.notifier.onAuthorizationComplete(result.request,result.response,result.error))})},AuthorizationRequestHandler.prototype.setAuthorizationNotifier=function(notifier){return this.notifier=notifier,this},AuthorizationRequestHandler}();exports.AuthorizationRequestHandler=AuthorizationRequestHandler},{"./logger":9}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var AuthorizationResponse=function(){function AuthorizationResponse(response){this.code=response.code,this.state=response.state}return AuthorizationResponse.prototype.toJson=function(){return{code:this.code,state:this.state}},AuthorizationResponse}();exports.AuthorizationResponse=AuthorizationResponse;var AuthorizationError=function(){function AuthorizationError(error){this.error=error.error,this.errorDescription=error.error_description,this.errorUri=error.error_uri,this.state=error.state}return AuthorizationError.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri,state:this.state}},AuthorizationError}();exports.AuthorizationError=AuthorizationError},{}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var xhr_1=require("./xhr"),AuthorizationServiceConfiguration=function(){function AuthorizationServiceConfiguration(request){this.authorizationEndpoint=request.authorization_endpoint,this.tokenEndpoint=request.token_endpoint,this.revocationEndpoint=request.revocation_endpoint,this.userInfoEndpoint=request.userinfo_endpoint,this.endSessionEndpoint=request.end_session_endpoint}return AuthorizationServiceConfiguration.prototype.toJson=function(){return{authorization_endpoint:this.authorizationEndpoint,token_endpoint:this.tokenEndpoint,revocation_endpoint:this.revocationEndpoint,end_session_endpoint:this.endSessionEndpoint,userinfo_endpoint:this.userInfoEndpoint}},AuthorizationServiceConfiguration.fetchFromIssuer=function(openIdIssuerUrl,requestor){var fullUrl=openIdIssuerUrl+"/.well-known/openid-configuration";return(requestor||new xhr_1.JQueryRequestor).xhr({url:fullUrl,dataType:"json"}).then(function(json){return new AuthorizationServiceConfiguration(json)})},AuthorizationServiceConfiguration}();exports.AuthorizationServiceConfiguration=AuthorizationServiceConfiguration},{"./xhr":16}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var base64=require("base64-js"),errors_1=require("./errors"),HAS_CRYPTO="undefined"!=typeof window&&!!window.crypto,HAS_SUBTLE_CRYPTO=HAS_CRYPTO&&!!window.crypto.subtle,CHARSET="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function bufferToString(buffer){for(var state=[],i=0;i<buffer.byteLength;i+=1){var index=buffer[i]%CHARSET.length;state.push(CHARSET[index])}return state.join("")}function urlSafe(buffer){return base64.fromByteArray(new Uint8Array(buffer)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function textEncodeLite(str){for(var buf=new ArrayBuffer(str.length),bufView=new Uint8Array(buf),i=0;i<str.length;i++)bufView[i]=str.charCodeAt(i);return bufView}exports.bufferToString=bufferToString,exports.urlSafe=urlSafe,exports.textEncodeLite=textEncodeLite;var DefaultCrypto=function(){function DefaultCrypto(){}return DefaultCrypto.prototype.generateRandom=function(size){var buffer=new Uint8Array(size);if(HAS_CRYPTO)window.crypto.getRandomValues(buffer);else for(var i=0;i<size;i+=1)buffer[i]=Math.random();return bufferToString(buffer)},DefaultCrypto.prototype.deriveChallenge=function(code){return code.length<43||128<code.length?Promise.reject(new errors_1.AppAuthError("Invalid code length.")):HAS_SUBTLE_CRYPTO?new Promise(function(resolve,reject){crypto.subtle.digest("SHA-256",textEncodeLite(code)).then(function(buffer){return resolve(urlSafe(new Uint8Array(buffer)))},function(error){return reject(error)})}):Promise.reject(new errors_1.AppAuthError("window.crypto.subtle is unavailable."))},DefaultCrypto}();exports.DefaultCrypto=DefaultCrypto},{"./errors":7,"base64-js":17}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var AppAuthError=function(message,extras){this.message=message,this.extras=extras};exports.AppAuthError=AppAuthError},{}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.IS_LOG=!0,exports.IS_PROFILE=!1},{}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var flags_1=require("./flags");function log(message){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];flags_1.IS_LOG&&(0<(args?args.length:0)?console.log.apply(console,[message].concat(args)):console.log(message))}exports.log=log;var NATIVE_PROFILE_SUPPORT="undefined"!=typeof window&&!!window.performance&&!!console.profile;exports.profile=function(target,propertyKey,descriptor){return flags_1.IS_PROFILE?function(target,propertyKey,descriptor){var originalCallable=descriptor.value,name=originalCallable.name;return name||(name="anonymous function"),descriptor.value=NATIVE_PROFILE_SUPPORT?function(args){console.profile(name);var startTime=window.performance.now(),result=originalCallable.call.apply(originalCallable,[this||window].concat(args)),duration=window.performance.now()-startTime;return console.log(name+" took "+duration+" ms"),console.profileEnd(),result}:function(args){log("Profile start "+name);var start=Date.now(),result=originalCallable.call.apply(originalCallable,[this||window].concat(args)),duration=Date.now()-start;return log("Profile end "+name+" took "+duration+" ms."),result},descriptor}(0,0,descriptor):descriptor}},{"./flags":8}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var BasicQueryStringUtils=function(){function BasicQueryStringUtils(){}return BasicQueryStringUtils.prototype.parse=function(input,useHash){return useHash?this.parseQueryString(input.hash):this.parseQueryString(input.search)},BasicQueryStringUtils.prototype.parseQueryString=function(query){for(var result={},params=(query=query.trim().replace(/^(\?|#|&)/,"")).split("&"),i=0;i<params.length;i+=1){var parts=params[i].split("=");if(2<=parts.length){var key=decodeURIComponent(parts.shift()),value=0<parts.length?parts.join("="):null;value&&(result[key]=decodeURIComponent(value))}}return result},BasicQueryStringUtils.prototype.stringify=function(input){var encoded=[];for(var key in input)input.hasOwnProperty(key)&&input[key]&&encoded.push(encodeURIComponent(key)+"="+encodeURIComponent(input[key]));return encoded.join("&")},BasicQueryStringUtils}();exports.BasicQueryStringUtils=BasicQueryStringUtils},{}],11:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var authorization_request_1=require("./authorization_request"),authorization_request_handler_1=require("./authorization_request_handler"),authorization_response_1=require("./authorization_response"),crypto_utils_1=require("./crypto_utils"),logger_1=require("./logger"),query_string_utils_1=require("./query_string_utils"),storage_1=require("./storage"),authorizationRequestKey=function(handle){return handle+"_appauth_authorization_request"},authorizationServiceConfigurationKey=function(handle){return handle+"_appauth_authorization_service_configuration"},RedirectRequestHandler=function(_super){function RedirectRequestHandler(storageBackend,utils,locationLike,crypto){void 0===storageBackend&&(storageBackend=new storage_1.LocalStorageBackend),void 0===utils&&(utils=new query_string_utils_1.BasicQueryStringUtils),void 0===locationLike&&(locationLike=window.location),void 0===crypto&&(crypto=new crypto_utils_1.DefaultCrypto);var _this=_super.call(this,utils,crypto)||this;return _this.storageBackend=storageBackend,_this.locationLike=locationLike,_this}return __extends(RedirectRequestHandler,_super),RedirectRequestHandler.prototype.performAuthorizationRequest=function(configuration,request){var _this=this,handle=this.crypto.generateRandom(10);Promise.all([this.storageBackend.setItem("appauth_current_authorization_request",handle),request.toJson().then(function(result){return _this.storageBackend.setItem(authorizationRequestKey(handle),JSON.stringify(result))}),this.storageBackend.setItem(authorizationServiceConfigurationKey(handle),JSON.stringify(configuration.toJson()))]).then(function(){var url=_this.buildRequestUrl(configuration,request);logger_1.log("Making a request to ",request,url),_this.locationLike.assign(url)})},RedirectRequestHandler.prototype.completeAuthorizationRequest=function(){var _this=this;return this.storageBackend.getItem("appauth_current_authorization_request").then(function(handle){return handle?_this.storageBackend.getItem(authorizationRequestKey(handle)).then(function(result){return JSON.parse(result)}).then(function(json){return new authorization_request_1.AuthorizationRequest(json)}).then(function(request){var currentUri=""+_this.locationLike.origin+_this.locationLike.pathname,queryParams=_this.utils.parse(_this.locationLike,!0),state=queryParams.state,code=queryParams.code,error=queryParams.error;logger_1.log("Potential authorization request ",currentUri,queryParams,state,code,error);var shouldNotify=state===request.state,authorizationResponse=null,authorizationError=null;if(shouldNotify){if(error){var errorUri=queryParams.error_uri,errorDescription=queryParams.error_description;authorizationError=new authorization_response_1.AuthorizationError({error:error,error_description:errorDescription,error_uri:errorUri,state:state})}else authorizationResponse=new authorization_response_1.AuthorizationResponse({code:code,state:state});return Promise.all([_this.storageBackend.removeItem("appauth_current_authorization_request"),_this.storageBackend.removeItem(authorizationRequestKey(handle)),_this.storageBackend.removeItem(authorizationServiceConfigurationKey(handle))]).then(function(){return logger_1.log("Delivering authorization response"),{request:request,response:authorizationResponse,error:authorizationError}})}return logger_1.log("Mismatched request (state and request_uri) dont match."),Promise.resolve(null)}):null})},RedirectRequestHandler}(authorization_request_handler_1.AuthorizationRequestHandler);exports.RedirectRequestHandler=RedirectRequestHandler},{"./authorization_request":2,"./authorization_request_handler":3,"./authorization_response":4,"./crypto_utils":6,"./logger":9,"./query_string_utils":10,"./storage":12}],12:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var StorageBackend=function(){},LocalStorageBackend=function(_super){function LocalStorageBackend(storage){var _this=_super.call(this)||this;return _this.storage=storage||window.localStorage,_this}return __extends(LocalStorageBackend,_super),LocalStorageBackend.prototype.getItem=function(name){var _this=this;return new Promise(function(resolve,reject){var value=_this.storage.getItem(name);resolve(value||null)})},LocalStorageBackend.prototype.removeItem=function(name){var _this=this;return new Promise(function(resolve,reject){_this.storage.removeItem(name),resolve()})},LocalStorageBackend.prototype.clear=function(){var _this=this;return new Promise(function(resolve,reject){_this.storage.clear(),resolve()})},LocalStorageBackend.prototype.setItem=function(name,value){var _this=this;return new Promise(function(resolve,reject){_this.storage.setItem(name,value),resolve()})},LocalStorageBackend}(exports.StorageBackend=StorageBackend);exports.LocalStorageBackend=LocalStorageBackend},{}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GRANT_TYPE_AUTHORIZATION_CODE="authorization_code",exports.GRANT_TYPE_REFRESH_TOKEN="refresh_token";var TokenRequest=function(){function TokenRequest(request){this.clientId=request.client_id,this.redirectUri=request.redirect_uri,this.grantType=request.grant_type,this.code=request.code,this.refreshToken=request.refresh_token,this.extras=request.extras}return TokenRequest.prototype.toJson=function(){return{grant_type:this.grantType,code:this.code,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,client_id:this.clientId,extras:this.extras}},TokenRequest.prototype.toStringMap=function(){var map={grant_type:this.grantType,client_id:this.clientId,redirect_uri:this.redirectUri};if(this.code&&(map.code=this.code),this.refreshToken&&(map.refresh_token=this.refreshToken),this.extras)for(var extra in this.extras)this.extras.hasOwnProperty(extra)&&!map.hasOwnProperty(extra)&&(map[extra]=this.extras[extra]);return map},TokenRequest}();exports.TokenRequest=TokenRequest},{}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var errors_1=require("./errors"),query_string_utils_1=require("./query_string_utils"),token_response_1=require("./token_response"),xhr_1=require("./xhr"),BaseTokenRequestHandler=function(){function BaseTokenRequestHandler(requestor,utils){void 0===requestor&&(requestor=new xhr_1.JQueryRequestor),void 0===utils&&(utils=new query_string_utils_1.BasicQueryStringUtils),this.requestor=requestor,this.utils=utils}return BaseTokenRequestHandler.prototype.isTokenResponse=function(response){return void 0===response.error},BaseTokenRequestHandler.prototype.performRevokeTokenRequest=function(configuration,request){return this.requestor.xhr({url:configuration.revocationEndpoint,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(request.toStringMap())}).then(function(response){return!0})},BaseTokenRequestHandler.prototype.performTokenRequest=function(configuration,request){var _this=this;return this.requestor.xhr({url:configuration.tokenEndpoint,method:"POST",dataType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(request.toStringMap())}).then(function(response){return _this.isTokenResponse(response)?new token_response_1.TokenResponse(response):Promise.reject(new errors_1.AppAuthError(response.error,new token_response_1.TokenError(response)))})},BaseTokenRequestHandler}();exports.BaseTokenRequestHandler=BaseTokenRequestHandler},{"./errors":7,"./query_string_utils":10,"./token_response":15,"./xhr":16}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.nowInSeconds=function(){return Math.round((new Date).getTime()/1e3)};var TokenResponse=function(){function TokenResponse(response){this.accessToken=response.access_token,this.tokenType=response.token_type||"bearer",this.expiresIn=response.expires_in,this.refreshToken=response.refresh_token,this.scope=response.scope,this.idToken=response.id_token,this.issuedAt=response.issued_at||exports.nowInSeconds()}return TokenResponse.prototype.toJson=function(){return{access_token:this.accessToken,id_token:this.idToken,refresh_token:this.refreshToken,scope:this.scope,token_type:this.tokenType,issued_at:this.issuedAt,expires_in:this.expiresIn}},TokenResponse.prototype.isValid=function(buffer){return void 0===buffer&&(buffer=600),!this.expiresIn||exports.nowInSeconds()<this.issuedAt+this.expiresIn+buffer},TokenResponse}();exports.TokenResponse=TokenResponse;var TokenError=function(){function TokenError(tokenError){this.error=tokenError.error,this.errorDescription=tokenError.error_description,this.errorUri=tokenError.error_uri}return TokenError.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri}},TokenError}();exports.TokenError=TokenError},{}],16:[function(require,module,exports){"use strict";var extendStatics,__extends=this&&this.__extends||(extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)},function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)});Object.defineProperty(exports,"__esModule",{value:!0});var errors_1=require("./errors"),Requestor=function(){},JQueryRequestor=function(_super){function JQueryRequestor(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(JQueryRequestor,_super),JQueryRequestor.prototype.xhr=function(settings){var xhr=$.ajax(settings);return new Promise(function(resolve,reject){xhr.then(function(data,textStatus,jqXhr){resolve(data)},function(jqXhr,textStatus,error){reject(new errors_1.AppAuthError(error))})})},JQueryRequestor}(exports.Requestor=Requestor);exports.JQueryRequestor=JQueryRequestor;var FetchRequestor=function(_super){function FetchRequestor(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(FetchRequestor,_super),FetchRequestor.prototype.xhr=function(settings){if(!settings.url)return Promise.reject(new errors_1.AppAuthError("A URL must be provided."));var url=new URL(settings.url),requestInit={};(requestInit.method=settings.method,requestInit.mode="cors",settings.data)&&(settings.method&&"POST"===settings.method.toUpperCase()?requestInit.body=settings.data:new URLSearchParams(settings.data).forEach(function(value,key){url.searchParams.append(key,value)}));if(requestInit.headers={},settings.headers)for(var i in settings.headers)settings.headers.hasOwnProperty(i)&&(requestInit.headers[i]=settings.headers[i]);var isJsonDataType=settings.dataType&&"json"===settings.dataType.toLowerCase();return isJsonDataType&&(requestInit.headers.Accept="application/json, text/javascript, */*; q=0.01"),fetch(url.toString(),requestInit).then(function(response){if(200<=response.status&&response.status<300){var contentType=response.headers.get("content-type");return isJsonDataType||contentType&&contentType.includes("application/json")?response.json():response.text()}return Promise.reject(new errors_1.AppAuthError(response.status.toString(),response.statusText))})},FetchRequestor}(Requestor);exports.FetchRequestor=FetchRequestor;var TestRequestor=function(_super){function TestRequestor(promise){var _this=_super.call(this)||this;return _this.promise=promise,_this}return __extends(TestRequestor,_super),TestRequestor.prototype.xhr=function(settings){return this.promise},TestRequestor}(Requestor);exports.TestRequestor=TestRequestor},{"./errors":7}],17:[function(require,module,exports){"use strict";exports.byteLength=function(b64){var lens=getLens(b64),validLen=lens[0],placeHoldersLen=lens[1];return 3*(validLen+placeHoldersLen)/4-placeHoldersLen},exports.toByteArray=function(b64){for(var tmp,lens=getLens(b64),validLen=lens[0],placeHoldersLen=lens[1],arr=new Arr(function(b64,validLen,placeHoldersLen){return 3*(validLen+placeHoldersLen)/4-placeHoldersLen}(0,validLen,placeHoldersLen)),curByte=0,len=0<placeHoldersLen?validLen-4:validLen,i=0;i<len;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[curByte++]=tmp>>16&255,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp;2===placeHoldersLen&&(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[curByte++]=255&tmp);1===placeHoldersLen&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[curByte++]=tmp>>8&255,arr[curByte++]=255&tmp);return arr},exports.fromByteArray=function(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,len2<i+16383?len2:i+16383));1===extraBytes?(tmp=uint8[len-1],parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"="));return parts.join("")};for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(b64){var len=b64.length;if(0<len%4)throw new Error("Invalid string. Length must be a multiple of 4");var validLen=b64.indexOf("=");return-1===validLen&&(validLen=len),[validLen,validLen===len?0:4-validLen%4]}function encodeChunk(uint8,start,end){for(var tmp,num,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(255&uint8[i+2]),output.push(lookup[(num=tmp)>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]);return output.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},{}]},{},[1]);